<h1>Carrito #{{cart._id}}</h1>

{{#if cart.products.length}}
<table border="1" cellpadding="10">
  <thead>
    <tr>
      <th>Producto</th>
      <th>Precio</th>
      <th>Cantidad</th>
      <th>Subtotal</th>
    </tr>
  </thead>
  <tbody>
    {{#each cart.products}}
    <tr>
      <td>{{this.product.title}}</td>
      <td>${{this.product.price}}</td>
      <td>{{this.quantity}}</td>
      <td>${{multiply this.product.price this.quantity}}</td>
    </tr>
    {{/each}}
  </tbody>
</table>

<h3>Total: ${{total cart.products}}</h3>
<button onclick="clearCart('{{cart._id}}')">Vaciar Carrito</button>

{{else}}
<p>El carrito está vacío.</p>
{{/if}}

<script>
  function clearCart(cid) {
    fetch('/api/carts/' + cid, { method: 'DELETE' })
      .then(res => res.json())
      .then(data => {
        alert('Carrito vaciado');
        location.reload();
      });
  }
</script>
